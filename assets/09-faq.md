---
title: 9. Часто задаваемые вопросы
section: 9
ignore-section-number: true
---

# Часто задаваемые вопросы

- <details>
    <summary><i>Проблема с торговым подключением к бирже: робот не выставляет заявки/не видит сделки, но ситуация не позволяет надолго остановить торговлю.</i></summary>

    1. Напишите письмо в поддержку с описанием проблемы;
    2. Выключите торговлю по всем портфелям, торгующим через данное транзакционное подключение, убедитесь, что не осталось активных заявок;
    3. Сбросьте статусы заявок по всем портфелям из пункта 2. Описание функционала `Reset statuses`[п.3.4.](03-getting-started.md#_3-4-управление-портфелями) ;
    4. Преподключите проблемное транзакционное подключение;
    5. Включите торговлю по портфелям из пункта 2;
    6. Если в течении пары часов проблема повторится, то выключите торговлю по всем портфелям, торгующим через данное транзакционное подключение, и больше не включайте, пока не получите ответ от поддержки.

    </details>
---
- <details>
    <summary><i>Торговля включается и выключается самопроизвольно. С чем это связано?</i></summary>

    Скорее всего задано расписание для торговли или специально задано такое поведение в формулах.

    </details>
---
- <details>
    <summary><i>Робот не торгует. Практически все подключения отключены. В чём может быть дело?</i></summary>

    Самая вероятная причина такого поведения - истёк срок лицензии. Проверьте сколько дней осталось до окончания лицензии. Количество дней до окончания лицензии можно увидеть в виджете `Robots` в строке таблицы, соотвествующей данному роботу, в столбце `Days paid`.

    </details>
---
- <details>
    <summary><i>Добавил портфель, все подключения к биржам подключены, торговля включена, но заявки по первой ноге не выставляются. В чём дело?</i></summary>

    При наведении на имя портфеля в списке портфелей появляется всплывающая подсказка. В ней отдельно для покупки и продажи первой ноги указывается, чего не хватает роботу для выставления заявки.
    Например, строка всплывающей подсказки для продажи портфеля имеет такой вид: "`sell: is signal=1, quantity=5, is valid market volume=1, is price check=0, is max not hedged=1, is orderbook valid=1`. `is_signal` означает, есть ли сигнал на покупку (т.е. либо мы сейчас котируем, либо выполняется условие на [Sell](05-params-description.md#p.sell) и [Lim_Sell](05-params-description.md#p.lim_s)). Если сигнал есть, то 1, иначе 0. Значения всех проверок могут быть только 0 или 1, если не указано иное. `quantity` показывает заявку какого объёма мы хотим выставить, исходя из заданных параметров портфеля. Заявка будет выставлена только при положительном значении объёма. Отрицательный объём не является ошибкой, это лишь результат расчётов. `is valid market volume` указывает прошла ли проверка на параметр [Market volume](05-params-description.md#p.mkt_volume). `is price check` указывает прошла ли проверка на параметр [Price check](05-params-description.md#p.price_check). `is max not hedged` указывает на выполнение или невыполнение условия [Max not hedget](05-params-description.md#p.max_not_hedged) для заявок по второй ноге. `is orderbook valid` отвечает за внешние признаки валидности стакана. Если стороны стакана на покупку и продажу пересекаются, то стакан не считается валидным. Таким образом, заявка выставляется только когда все значения больше нуля.
    
    </details>
---
- <details>
    <summary><i>Отсутствует нужный инструмент в списке инструментов биржи. Где его взять?</i></summary>

    Список бумаг в роботе обновляется каждое утро в 6:05 по времени сервера, время сервера можно посмотреть в виджете `Robots` в строке таблицы, соотвествующей данному роботу, в столбце `Robot time`. Чтобы выгрузить список бумаг нажмите `Reload security list from exchanges`. Если вы не видите какой-то бумаги в списке бумаг (при этом вы обновили список), а эта бумага уже есть на бирже, то либо дождитесь указанного выше времени и бумага добавится сама, либо переподключите маркет-дата подключение и после этого обновите список бумаг.
    
    </details>
---
- <details>
    <summary><i>Сегодня на бирже были добавлены новые бумаги, но в роботе я их не вижу. Что делать?</i></summary>

    Новые бумаги выгружаются рано утром и робот мог не успеть подгрузить их. Нужно переподключить дата подключение к бирже. Затем обновить список бумаг и новые инструменты будут доступны.
    
    </details>
---
- <details>
    <summary><i>Добавил портфель, изменял настройки, а они не применились и портфель исчез, что происходит?</i></summary>

    Проверьте, один ли Вы редактируете что-либо в роботе, возможно Ваш коллега делает тоже самое и вы мешаете друг другу.
    
    </details>
---
- <details>
    <summary><i>Почему по несколько раз выставляется объем на одинаковой раздвижке? Параметр К у меня отличен он нуля.</i></summary>

    [Sell](05-params-description.md#p.sell) стал сильно больше [Lim_Sell](05-params-description.md#p.lim_s). И при подвижке на [K](05-params-description.md#p.k) мы догоняли цену на бирже.
    Пример: Вы хотите продать по 100, `К`=1. В какой то момент цена подскакивает и становится равна 105. И вы продаёте по 105, но при этом робот, по алгоритму продал по 100, затем подвинул на `К`, стал продавать по 101. Продал снова по 105, робот снова подвинул на `К`, стало 102 и снова продал по 105 и т.д.. Таким образом все эти продажи произойдут по цене 105.
    
    </details>
---
- <details>
    <summary><i>Как уменьшить количество проскальзываний по инструментам второй ноги?</i></summary>

    Для этого стоит обратить внимание на параметры [k](05-params-description.md#_5-3-12-k) и [Percent of quantity](05-params-description.md#s.percent_of_quantity) у инструмента второй ноги в разделе `Securities`. Их настройка может существенно повлиять на исполнение заявок второй ноги.
    
    Увеличение значения для параметра [k](05-params-description.md#_5-3-12-k) потенциально ухудшает цену исполнения, но увеличивает саму вероятность исполнения заявки. Увеличение [Percent of quantity](05-params-description.md#s.percent_of_quantity) поможет добиться более уверенного хеджирования, т.к. заявка по первой ноге будет выставляться только тогда, когда есть достаточно объема для хеджирования на второй ноге.
    
    </details>
---
- <details>
    <summary><i>У меня часто выскакивает ошибка REASON_FLOOD, что делать чтобы её избежать?</i></summary>

    **Если ошибка возникает при выставлении заявок по [Is first](05-params-description.md#_5-3-11-is-first) инструменту:**
    
    возникновение такой ошибки, означает использование режима котирования ([Quote](05-params-description.md#p.quote)). Можно попробовать торговать не в режиме котирования, тогда транзакции будут отправляться реже. Если без режима котирования не обойтись, то стоит обратить внимание на параметры группы "Anti-spam", в частности на параметр [Delta](05-params-description.md#p.delta).
    [Delta](05-params-description.md#p.delta) - это отклонение [Price_s/Price_b](05-params-description.md#p.price_s) от цены выставленной заявки, после которого заявка переставляется, то есть отправляется транзакция. Вам необходимо выставлять её таким образом, чтобы заявка не переставлялась от малейших колебаний. То есть, например, вы торгуете BTCUSD, и его стоимость 10 000. Вы ставите [Delta](05-params-description.md#p.delta) равным единице. Какова вероятность изменения [Price_s/Price_b](05-params-description.md#p.price_s) на доллар в случае, когда инструмент стоит 10 000 долларов? Вероятность велика, за секунду может несколько раз измениться цена на этот доллар и каждый раз робот будет отправлять приказы на удаление старой заявки и установки новой. Так и происходит спам биржи. Если поставить [Delta](05-params-description.md#p.delta) равным 5-10, то вероятность заспамить биржу уменьшится, так как должно произойти более весомое изменение, для отправления заявок.
    Настройте параметр [Market volume](05-params-description.md#p.mkt_volume). Если перед вами будет стоять большой объем, то особого смысла сейчас стоять нет и можно так же не спамить биржу переставлениями.  
    **Важно:** в режиме торговли `bid/offer` данный параметр "видит" только объемы бида и оффера. Это значит, что если за ними еще стоят объемы, то робот их не увидит и будет ставить заявки. Потому используйте данный параметр преимущественно в режиме `orderbook` и `orderbook+filter`.  
    Параметр [Price check](05-params-description.md#p.price_check). Если [Price_s/Price_b](05-params-description.md#p.price_s) отличается от `bid/offer` больше чем на [Price check](05-params-description.md#p.price_check) пунктов, то не выставляемся и снова не спамим биржу. Естественно чем меньше значение, тем меньше спама.
    Также можно установить большой [TP](05-params-description.md#_5-3-26-tp), чтобы брать реже, но больше.

    **Если ошибка возникает при выставлении заявок по не Is first инструментам:**
    
    Видимо, заявку по первой ноге разбирают маленькими порциями, и после каждой такой сделки происходит выставление заявок по инструментам второй ноги. Обратите внимание на параметр [Overlay](05-params-description.md#p.overlay), он позволяет выставлять хеджирующие заявки не после каждой сделки по первой ноге.
    
    </details>
---
- <details>
    <summary><i>Сделки в роботе не совпадают со сделками в терминале. В чём может быть причина?</i></summary>

    Робот не использует цены сделок в алгоритме, они нужны только для отображения клиенту. Более того, на многих подключениях нельзя получить цену конкретной сделки. По этой причине и в угоду скорости работы робот может считать ценой сделки цену выставления заявки или среднюю цену исполнения сделок по заявке. Кроме того на некоторых подключениях несколько прошедших подряд сделок могут быть учтены роботом как одна сделка, прошедшая суммарным объёмом. Такое поведение робота не является ошибочным, потери позиций при этом не происходит.
    
    </details>
---
- <details>
    <summary><i>Я не вижу портфель, но я точно его создавал, робот не даёт мне создать новый портфель с тем же именем. В чём может быть дело?<Anchor :ids="['faq.filter']" /> </i></summary>

    Скорее всего в таблице портфелей применен фильтр и данный портфель не выбран в фильтре. Нажмите на надпись "FILTER APPLIED" в виджете `Portfolios table` и отметьте галочкой нужный портфель.
    
    </details>
---
- <details>
    <summary><i>Не могу создать портфель, получаю сообщение что портфель с таким именем уже существует. Я точно такой портфель не создавал. В чём может быть дело?</i></summary>

    Сначала следует убедиться, что Вы действительно не создавали такой портфель, для этого проверьте фильтр портфелей, как описано [выше](#faq.filter). Если это не помогло, то скорее всего в роботе существует портфель с таким именем, созданный другим пользователем. Вы не можете видеть портфели, созданные другими пользователями, но при этом уникальность имён портфелей должна соблюдаться среди всех портфелей робота. Если такая ситуация наблюдается на бесплатном роботе, то это нормально, этими роботами действительно пользуется большое количество трейдеров. Если же ситуация наблюдается в боевом роботе, то уточнить торгует ли кто-то еще тем же роботом можно у старшего трейдера (Head of traders).
    
    </details>
---
- <details>
    <summary><i>Возможно ли как-то настроить робота, чтобы он перекрывал часть Is_first ноги, если по ней набрано меньше 5 контрактов? Условно 2 набрал по первой ноге, перекрыл 3 на второй ноге (При этом сохранив Count 5 к 8)?</i></summary>

    Вводные данные: `Curpos`=19, `Count`=5  
    По умолчанию позиция портфеля округляется вниз до целого значения `Curpos` деленный на `Count` (главная нога), соответственно и хедж будет происходить при изменении позиции портфеля.  
    При n_perc_fill=0, округление по модулю вниз, т.е. |19/5=3|;  
    При n_perc_fill=80:  
    Предположим, позиция изменилась стала Curpos=18, целая часть от деления |18/5|=3 - не изменилась,
    остаток от деления =3. (100 - n_perc_fill)=100-80=20, 20% от count (т.е. от 5) =1, 80% от count =4.  
    Остаток от деления 3 находится в диапазоне между 1 и 4, значит позиция по портфелю не меняется. Pos=3.  
    Таким образом видно, что позиция изменится в меньшую сторону при Curpos<=15 и в большую сторону при Curpos>=20.
    
    </details>
---
- <details>
    <summary><i>Как настроить уведомления о резком изменении раздвижек?</i></summary>

   Уведомления настраиваются в настройках портфеля на вкладке `Notifications`.
   
   </details>
---
- <details>
    <summary><i>в разделе Financial result вместо дельты часто показывается цена актива, который торгуется в портфеле. Как это влияет на Average sell and buy?</i></summary>
    
    Расчеты ведутся на основании сделок за выбранный период для продаж и покупок отдельно, не на основании раздвижек (дельты). Соответственно, что пришло в Financial result (дельта или цена) не важно, это не влияет на подсчет Average sell and buy.
    
    </details>
---
- <details>
    <summary><i>Какие типы заявок использует робот? Возможно ли выставление роботом рыночной заявки?</i></summary>

    Робот использует только лимитные котировочные заявки. Выставление заявок типа "рыночная" невозможно, но можно имитировать такие заявки путём выставления лимитной заявки вглубь противоположной стороны стакана с помощью параметра [k](05-params-description.md#_5-3-12-k) соответствующего инструмента в настройках портфеля в разделе `Securities`.
    
    </details>
---
- <details>
    <summary><i>Какие действия осуществляет робот при потере соединения на одной из ног?</i></summary>

    Зависит от того, на какой ноге и в какой момент. Если первая нога потеряла связь, портфель, в котором инструменты из биржи с потерянным соединением, перестает торговать. Если потерялась связь с второй ногой, а первая нога не успела пройти, то робот, также перестает торговать этот портфель. Если первая нога успела пройти, в этот момент вторая нога еще не встала, но успела потерять связь, то робот продолжает пытаться выставиться (рейт-лимиты конечно учитываются).
    
    </details>
---
- <details>
    <summary><i>Надо ли оставлять страницу браузера открытой, чтобы всё продолжало работать. Что произойдёт с моими позициями, если я закрою браузер или перезагружу компьютер?</i></summary>

    Функционирование роботов не зависит от того, открыта ли вкладка в браузере у пользователя или нет. Вы можете эту страницу закрыть, открыть в другом месте, одновременно с разных мест, перезагрузить свой компьютер и т.д., это ни на что не влияет. Роботы запущены на наших серверах и функционируют автономно. Полсе авторизации на сайте Вы получаете возможность управлять доступными Вам роботами. Есть отдельная опция - запустить робота на Вашем сервере.
    
    </details>
---   
- <details>
    <summary><i>На инструментах срочного рынка Московской биржи цены в роботе отличаются от цен в терминале. С чем это связано?</i></summary>

    На срочном рынке Московской бирже применется синтетический матчинг. Он связан с торговлей [календарными спредами](https://www.moex.com/ru/spreads). При использовании синтетического матчинга сделки формируются на основе заявок, поступающих в разные стаканы связанных инструметнов (двух фьючерсов и календарного спреда). Таким образом, в процессе матчинга строится синтетика любой глубины, необходимой для сведения активных заявок. Подробно синтетический матчинг описан в разделе 2.9 документации на [PLAZA II шлюз](https://ftp.moex.com/pub/ClientsAPI/Spectra/CGate/prod/docs/p2gate_ru.pdf)
    
    Биржа может транслировать стакан в двух вариантах: в виде уже собранного агрегированного стакана и в виде полного списка изменения статусов всех заявок по инструменту. Во втором случае построение агрегированного стакана производится уже на стороне робота или терминала. Чаще всего в торговых терминалах используется получение готового агрегированного стакана с биржи. При трансляции агрегированного стакана биржа индикативно транслирует так же 5 уровней, сформированных синтетическими заявками. Более подробно о том, что такое синтетические индикативные котировки и как они используются в агрегированном стакане, можно прочитать в разделе 2.9.2 документации на [PLAZA II шлюз](https://ftp.moex.com/pub/ClientsAPI/Spectra/CGate/prod/docs/p2gate_ru.pdf).
    
    В роботе для получения маркет-даты срочного рынка Московской биржи используются только потоки `Orderlog` подключений по протоколам [FAST](04-creating-connection.md#tc.MOEX_FUT_OPT.FAST) и [SIMBA](04-creating-connection.md#tc.MOEX_FUT_OPT.SIMBA) как наиболее быстрый способ получения рыночной информации, построение агрегированного стакана по инструменту проводится роботом только на основе данных по этому инструменту. Данные по связанным инструментам не используются по нескольким причинам:
    * У инструментов отсутствуют машиночитаемые признаки, определяющие связь с другими инструментами. Идентификация возможна только по имени инструментов.
    * Достроение синтетических уровней требует получения данных по другим инструментам и занимает значительное время.
    * Непонятно сколько уровней требуется достраивать. 5 уровней, достраиваемые биржей при трансляции агрегированных стаканов не отображают полной картины, которая будет построена внутри биржи лишь непосредственно в момент матчинга.
    
    </details>
---
- <details>
    <summary><i>Вижу сообщения с ошибкой выставления заявки по портфелю, они начинается со слов "Stop trading!!!", но торговля по портфелю до сих пор не выключена, ошибки продолжаются. Как такое возможно?</i></summary>

    Такое возможно при использовании формул, когда код в формулах управляет включением торговли по портфелю напрямую или через включение расписания (с помощью методов `set_re_sell`, `set_re_buy`, `set_use_tt`). При написании формул рекомендуется учитывать возможность отключения роботом торговли по портфелю при получении отпределенных ошибок выставления заявок.
    
    </details>
---
- <details>
    <summary><i>Пришло письмо с просьбой выключить торговлю в связи с обновлением робота. Что именно я должен сделать?</i></summary>

    Необходимо выключить торговлю по всем портфелям робота (например, с помощью [действий](03-getting-started.md#portfolio_actions) виджета `Portfolios table`) и убедиться, что на биржах не осталось висеть заявок, выставленных роботом. Закрывать позицию в ноль не требуется.
    
    С особой внимательностью при остановке торговли следует отнестись к тем портфелям, где используется [расписание](05-params-description.md#p.use_tt) (если расписание включает торговлю, то оно должно быть отключено), и к тем портфелям, где управление установкой флагов [re_sell/re_buy](05-params-description.md#p.re_buy) осуществляется через формулы (формулы по выбранным портфелям можно отключить вместе с выключением торговли по выбранным портфелям с помощью действия [Stop formulas](03-getting-started.md#portfolio_actions.stop_formulas)). Не забудьте включить расписание и формулы после обновления робота.
    
    </details>
---    
- <details>
    <summary><i>Могу ли я создавать портфели и вносить изменения в существующие портфели в неторговые дни?</i></summary>

    Вы можете редактировать настройки портфелей в неторговые дни. Добавление новых инструментов в портфель и создание новых портфелей не гаратируется, так как для создания нового портфеля и добавления инструментов в существующий портфель роботу необходим список инструментов. Если список был загружен роботом с биржи ранее, то Вы сможете как создать портфель, так и добавить инструменты в существующий портфель в неторговое время. Но возможны случаи, когда для проведения обновления и других работ выполняется перезапуск роботов в неторговое время, в таком случае список инструментов робот сможет загрузить только с возобновлением трансляции данных с биржи в торговые дни. Это не является ошибкой. Мы оставляем за собой право на перезапуск роботов и проведение других работ в неторговое время биржи.
    
    </details>
---    
- <details>
    <summary><i>Какие системные требования предъявляются к компьютеру, на котором будет открыт сайт с роботами?</i></summary>

    Работа сайта тестировалась в браузере Google Chrome. Сайт передает большое количество данных, поэтому на компьютере рекомендуется иметь минимум 4 ГБ оперативной памяти и минимум 2 ядра процессора. Также необходимо открыть доступ к сайту [bot.fkviking.com](https://bot.fkviking.com) в фаерволе.
    
    </details>
---    
- <details>
    <summary><i>Возможно ли принять участие в тестировании, проводимом Московской биржей на боевом контуре в неторговый день? </i></summary>
    
    Участие наших роботов в таких тестированиях не предусмотрено. Подключения к рынкам Московской Биржи автоматически отключаются в выходные дни чтобы избежать попадания тестовых данных в боевые системы, как и рекомендует сама биржа.
    
    Перед обновлением торговой системы на боевом контуре Московская биржа сначала развертывает новую версию торговой системы на тестовом контуре T1, там мы и тестируем работу робота с новой версией торговой системы. Таким образом, к моменту обновления боевого контура совместимость робота с новой версией торговой системой уже протестирована, и участие трейдеров в тестировании на боевом контуре не требуется.
    
    </details>
    
